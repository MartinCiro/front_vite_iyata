import{n as E,A as M,y as P,k as q,p as F,c as L,a as r,b as e,e as d,j as k,h as s,r as z,d as O,i as p,f as w,g as T,z as x,q as R,t as c,B as A,u as G,o as g}from"./index-VqPlM1MX.js";import{_ as H}from"./AppLayout-CF_FfTgD.js";import{_ as j,a as J}from"./Button-DYYX2dmu.js";import{u as K}from"./useTasks-CwPyd9XD.js";import{u as Q}from"./useProjects-S8qiQkYI.js";import{u as W}from"./useForm-BaGdoIoh.js";import{r as X}from"./ArrowLeftIcon-Bor2sICF.js";const Y={class:"py-6"},Z={class:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8"},tt={class:"mb-6"},et={class:"text-xl font-semibold text-gray-900"},st={key:0,class:"text-sm text-gray-600 mt-1"},at={key:0,class:"text-red-500 text-sm mt-1"},ot={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},rt={class:"flex justify-end space-x-3 pt-4"},ft=E({__name:"TaskForm",setup(lt){const f=M(),D=G(),i=Number(f.params.projectId),n=f.params.taskId?Number(f.params.taskId):null,{createTask:S,updateTask:C,fetchTask:h,isLoading:I,currentTask:l}=K(),{fetchProject:V,currentProject:v}=Q(),u=P(()=>!!n),y=q(!1),B={title:{required:"Task title is required",minLength:3,minLengthMessage:"Task title must be at least 3 characters"}},{form:a,errors:b,validate:N,validateField:$}=W({title:"",description:"",status:"todo",due_date:""},B),U=async()=>{if(N()){y.value=!0;try{const m={title:a.title,description:a.description,status:a.status,due_date:a.due_date?new Date(a.due_date).toISOString():new Date(Date.now()+6048e5).toISOString(),project_id:i};u.value&&n?await C(n,m):await S(m),D.push(`/projects/${i}/tasks`)}catch(m){console.error("Error saving task:",m)}finally{y.value=!1}}};return F(async()=>{await V(i),u.value&&n&&(await h(n),l.value&&(a.title=l.value.title||"",a.description=l.value.description||"",a.status=l.value.status||"todo",a.due_date=l.value.due_date?l.value.due_date.split("T")[0]:""))}),(m,t)=>{const _=z("router-link");return g(),L(H,null,{default:r(()=>[e("div",Y,[e("div",Z,[e("div",tt,[d(_,{to:`/projects/${s(i)}/tasks`,class:"text-blue-600 hover:text-blue-800 flex items-center"},{default:r(()=>[d(s(X),{class:"w-4 h-4 mr-1"}),t[5]||(t[5]=k(" Back to Tasks ",-1))]),_:1},8,["to"])]),d(J,null,{header:r(()=>[e("h1",et,c(u.value?"Edit Task":"Create New Task"),1),s(v)?(g(),w("p",st," Project: "+c(s(v).name),1)):T("",!0)]),default:r(()=>[e("form",{onSubmit:O(U,["prevent"]),class:"space-y-6"},[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Task Title * ",-1)),p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s(a).title=o),type:"text",placeholder:"Enter task title",class:R(["block w-full rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2",{"border-red-500":s(b).title}]),onBlur:t[1]||(t[1]=o=>s($)("title"))},null,34),[[x,s(a).title]]),s(b).title?(g(),w("p",at,c(s(b).title),1)):T("",!0)]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Description ",-1)),p(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>s(a).description=o),rows:"4",class:"block w-full rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2",placeholder:"Describe the task..."},null,512),[[x,s(a).description]])]),e("div",ot,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Status ",-1)),p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>s(a).status=o),class:"block w-full rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2"},[...t[8]||(t[8]=[e("option",{value:"todo"},"To Do",-1),e("option",{value:"in_progress"},"In Progress",-1),e("option",{value:"done"},"Done",-1)])],512),[[A,s(a).status]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Due Date ",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s(a).due_date=o),type:"date",class:"block w-full rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 px-3 py-2"},null,512),[[x,s(a).due_date]])])]),e("div",rt,[d(_,{to:`/projects/${s(i)}/tasks`},{default:r(()=>[d(j,{variant:"outline",type:"button"},{default:r(()=>[...t[11]||(t[11]=[k(" Cancel ",-1)])]),_:1})]),_:1},8,["to"]),d(j,{variant:"primary",type:"submit",loading:s(I),"loading-text":u.value?"Updating...":"Creating..."},{default:r(()=>[k(c(u.value?"Update Task":"Create Task"),1)]),_:1},8,["loading","loading-text"])])],32)]),_:1})])])]),_:1})}}});export{ft as default};
